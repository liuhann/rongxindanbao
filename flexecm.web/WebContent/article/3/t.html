<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="A layout example that shows off a blog page with a list of posts.">

	<title>来拿网</title>
	<link rel="stylesheet" href="../../css/pure-min.css">
	
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
  
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="/combo/1.18.13?/css/layouts/blog-old-ie.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="../../css/blog.css">
    <!--<![endif]-->
    
	<SCRIPT type=text/javascript src="../../js/jquery.min.js"></SCRIPT>
	
	<style type="text/css">
	
	.meta-info {
		margin-top: 10px;
		padding: 5px 0px 15px 0px;
		font-size: 13px;
		color: #666;
		border-bottom: 1px solid #e6e6e6;
		white-space: nowrap !important;
	}
	
	
	
	</style>
</head>
<body>


<div id="layout" class="pure-g">

	<div class="sidebar pure-u-1 pure-u-md-1-4">
        <div class="header">
            <h1 class="brand-title">来拿技术</h1>
            <nav class="nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a class="pure-button" href="/">回首页</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
	
	 <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            <!-- A wrapper for all the blog posts -->
            <div class="posts">
                <h1 class="content-subhead">技术博客</h1>

                <!-- A single blog post -->
                <section class="post">
                    <header class="post-header">
                        <h2 class="post-title">HTML5 File API简介及文件浏览功能实现</h2>
                        <p class="post-meta">
                            		作者：<a href="#" class="post-author">寒流</a> 分类 ： <a class="post-category post-category-design" href="#">学习HTML5</a> <a class="post-category post-category-pure" href="#">cordova教程</a>
                        </p>
                    </header>
					<div class="meta-info">
					    <span class="meta-item">
					        <span class="meta-create meta-col">
					            <i></i>
					            <span>创建时间：</span>
					            2015-3-5 11:34</span>
					    </span>
					    <span class="meta-item">
					        <span class="meta-update meta-col">
					            <i></i>
					            <span>修改时间：</span>
					            2015-3-9 11:24</span>
					    </span>
					</div>
                    <div class="post-description">
                      <div class="note-content"><div><br></div><div><b>Cordova插件简介</b></div><div><br></div><div>&nbsp; &nbsp; 我们之前已经知道设备的功能都是以插件形式提供的。 &nbsp;Cordova官方提供了十几个常用的功能插件，如果您需要的功能无法实现，您也可以到Cordova的插件库中去找&nbsp;<a href="http://plugins.cordova.io/" style="line-height: 1.5;">http://plugins.cordova.io/</a>&nbsp;或者自己写一个。</div><div><br></div><div>增加插件</div><div><pre style="background-color:rgb(238, 238, 255);color:rgb(59, 72, 84);font-size:17px;font-style:normal;font-weight:300;text-align:justify;"><code style="background-color:rgb(238, 238, 255);">cordova plugin add [PLUGIN_ID]</code></pre></div><div>而删除插件则用</div><div><pre style="background-color:rgb(238, 238, 255);color:rgb(59, 72, 84);font-size:17px;font-style:normal;font-weight:300;text-align:justify;"><code style="background-color:rgb(238, 238, 255);">cordova plugin remove [PLUGIN_ID]</code></pre>或者列举插件用</div><div><pre style="background-color:rgb(238, 238, 255);color:rgb(59, 72, 84);font-size:17px;font-style:normal;font-weight:300;text-align:justify;"><code style="background-color:rgb(238, 238, 255);">cordova plugin list</code></pre></div><div><br></div><div>因为插件和Native支持相关，因此很多插件可能支持1到多个平台。 当您增加插件后，插件的源代码也会附加到工程中，有需求您还可以自行修改</div><div><br></div><div><span style="line-height: 1.5;">因为我们要制作一个文件管理器， 需要的插件就是&nbsp;</span><a href="http://plugins.cordova.io/#/package/org.apache.cordova.file" style="background-color: rgb(255, 255, 255); color: rgb(76, 194, 228); font-family: Lato, sans-serif; font-size: 16px;">org.apache.cordova.file</a></div><div><span style="line-height: 1.5;">我们运行&nbsp;</span></div><div><pre style="background-color:rgb(238, 238, 255);color:rgb(59, 72, 84);font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;font-size:17px;font-style:normal;font-weight:300;text-align:justify;"><code style="background-color:rgb(238, 238, 255);font-family:Monaco, Consolas, Courier, 'Lucida Console', monospace;font-style:normal;">cordova plugin add <a href="http://plugins.cordova.io/#/package/org.apache.cordova.file" style="background-color:rgb(255, 255, 255);color:rgb(76, 194, 228);font-family:Lato, sans-serif;font-size:16px;font-style:normal;font-weight:normal;text-align:left;">org.apache.cordova.file</a></code></pre></div><div>添加后我们项目目录里也增加了JS和Java文件&nbsp;</div><div><img data-media-type="image" src="http://note.youdao.com/yws/public/resource/606986960376c507955eb4cd328b0108/BD68807E96D447D89EB9A06EB7FE5EEB" style="height: auto;"></div><div><br></div><div><br></div><span style="background-color: rgb(255, 255, 255);"><b>HTML5 File API 简介</b></span><div><b><br></b><div>W3C中&nbsp;<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">File</span><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp;</span><span title="Application Programming
      Interface" style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">API是一个协议族，包括了&nbsp;</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">File</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">&nbsp;</span><span title="Application Programming
      Interface" style="background-color: rgb(255, 255, 255); line-height: 1.5;">API</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">: Directories and System 和 &nbsp;</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">File</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">&nbsp;</span><span title="Application Programming
      Interface" style="background-color: rgb(255, 255, 255); line-height: 1.5;">API</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">: Writer ，分别是用来操作文件系统和操作具体文件。 &nbsp;当引入cordova &nbsp;file插件后，我们就可以按此协议约定来访问设备上的存储内容了 &nbsp;我们主要用</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">File</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">&nbsp;</span><span title="Application Programming
      Interface" style="background-color: rgb(255, 255, 255); line-height: 1.5;">API</span><span style="background-color: rgb(255, 255, 255); line-height: 1.5;">: Directories and System， 它的地址是</span></div><div><a href="http://www.w3.org/TR/2012/WD-file-system-api-20120417/" style="line-height: 1.5;">http://www.w3.org/TR/2012/WD-file-system-api-20120417/</a></div><div><br></div><div>当然，阅读一个协议比较烦，有兴趣推荐阅读 MDN上的文章</div><div><a href="https://developer.mozilla.org/en-US/docs/WebGuide/API/File_System/Introduction" style="line-height: 1.5;">https://developer.mozilla.org/en-US/docs/WebGuide/API/File_System/Introduction</a></div><div><br></div><div>File API是以异步回调的方式来提供的。因此我们的调动形式基本如下</div><div><br></div><div>func(参数，返回正确的回调, 返回错误的回调 )<br><div><br></div><div>通常我们会<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">同时</span>实现2个回调。 不实现错误回调函数， 和我们捕获到异常不处理是一个结局。</div><div><br></div><div><br></div><div><br></div><div></div></div></div><b style="background-color: rgb(255, 255, 255);">File API主要对象</b><div><div></div><div><br></div><div>&nbsp;Entry &nbsp;表示一个文件系统节点，实际上就是文件或文件夹</div><div></div></div><span style="background-color: rgb(255, 255, 255);">&nbsp;<span><span>DirectoryEntry</span><span>&nbsp;表示一个文件夹</span></span></span><div>&nbsp;FileEntry &nbsp;表示文件</div><div><br></div><div>其中&nbsp;<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">DirectoryEntry</span><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; 和&nbsp;<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">FileEntry &nbsp; 都继承了<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">Entry &nbsp;&nbsp;</span></span></span></div><div><br></div><div>Entry的主要属性如下</div><div><br><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>isFile</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Boolean. True if the entry is a file.</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>isDirectory</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span><span>Boolean. True if the entry is a directory.</span></span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>name</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>DOMString. The name of the entry, excluding the path leading to it</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px; height: 55px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>fullPath</span><br></span></div></td><td valign="top" style="width: 279px; height: 55px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>DOMString. The full absolute path from the root to the entry.</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>filesystem</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>FileSystem</span><span>. The filesystem on which the entry resides.</span></span><br></div></td></tr></tbody></table><div><div><a href="http://www.w3.org/TR/2012/WD-file-system-api-20120417/#the-directoryentry-interface" style="background-color:rgb(255, 255, 255);color:rgb(102, 0, 153);font-family:sans-serif;font-size:medium;font-style:normal;font-weight:normal;text-align:left;"><span></span></a></div><div><br></div><div>方法如下</div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>getMetadata<span>&nbsp;</span></span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Look up metadata about this entry</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px; height: 29px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>moveTo</span><br></span></div></td><td valign="top" style="width: 279px; height: 29px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Move an entry to a different location on the filesystem.</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>copyTo<span>&nbsp;</span></span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Copies an entry to a different parent on the filesystem.<span>&nbsp;</span></span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>toURL&nbsp;</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Returns a URL that can be used to identify this entry.<span>&nbsp;</span></span><br></span></div></td></tr><tr><td valign="top" style="width: 279px; height: 30px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>remove<span>&nbsp;</span></span><br></span></div></td><td valign="top" style="width: 279px; height: 30px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>Deletes a file or directory.</span><br></span></div></td></tr><tr><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span style="background-color: rgb(255, 255, 255);"><span>getParent</span><br></span></div></td><td valign="top" style="width: 279px;"><div style="line-height: 21px;"><span><span style="background-color: rgb(255, 255, 255);">Look up the parent DirectoryEntry containing this Entry.<span>&nbsp;</span></span></span><br></div></td></tr></tbody></table></div><div><br></div><div><br></div><div></div></div></div><b style="background-color: rgb(255, 255, 255);">获取一个Entry</b><div><div></div><div><br></div><div>首先，我们要获取存储根目录，通过以下方法</div><div><br></div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 693px; height: 137px;"><div>window.resolveLocalFileSystemURL(cordova.file.externalRootDirectory, function(entries) {
</div><div>&nbsp; &nbsp; &nbsp;openDir(entries);
</div><div>&nbsp;}, function() {
</div><div>&nbsp; &nbsp; &nbsp; alert("error");
</div><div>&nbsp;});</div></td></tr></tbody></table></div><div><br></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">resolveLocalFileSystemURL根据给定路径获取一个节点。&nbsp;<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">cordova.file.externalRootDirectory是内置的一个节点路径。表示SD卡根路径的位置。Cordova根据不同设备，给出了不同的节点路径。 在iOS设备上可能要使用不同的节点路径。&nbsp;</span></span></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><br></span></span></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">在&nbsp;</span></span><a href="https://github.com/apache/cordova-plugin-file/blob/master/doc/index.md" style="line-height: 1.5;">https://github.com/apache/cordova-plugin-file/blob/master/doc/index.md</a></div><div>中给出了iOS、andriod、BB10的路径变量名</div><div><br></div><div>在一些安卓设备上可能有2个存储卡，一个是手机自带的，一个可能是外置卡。 cordova实际上只能取出一个，就是手机数据存储的地方。另一个一般应用可能不会去读写。 在本课程中，我们就用这个来进行操作。</div><div><br></div><div><br></div><div></div></div><b style="background-color: rgb(255, 255, 255);">读取目录下的子节点</b><div><b><br></b></div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 579px;"><div><span style="background-color: rgb(255, 255, 255);">dirEntry.createReader().readEntries(function(entries) {</span></div><div><span style="background-color: rgb(255, 255, 255);"><br></span></div><div><span style="background-color: rgb(255, 255, 255);">});</span></div></td></tr></tbody></table></div><div><b><br></b></div><span style="background-color: rgb(255, 255, 255);">调用<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">DirectoryEntry</span><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp;的<span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">createReader方法获取一个</span></span></span><span style="color: rgb(0, 90, 156); font-weight: bold; font-family: Monaco, Consolas, Courier, 'Lucida Console', monospace; background-color: rgb(255, 255, 255); line-height: 1.5;">DirectoryReader</span><span style="background-color: rgb(255, 255, 255);">对象，再调用它唯一的方法readEntries就返回所有子节点了</span><div><br></div><div>因为这个数组是无序的，我们可以对其做一个排序处理。</div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 579px;"><div><span style="font-size: inherit; line-height: 1.5;">function orderFileEntry(entries) {&nbsp;</span></div><div>&nbsp; entries.sort(function(a,b) {
</div><div>&nbsp; &nbsp; &nbsp; if (a.isDirectory &amp;&amp; b.isFile) {
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; return -1;
</div><div>&nbsp; &nbsp; &nbsp; } else if (b.isDirectory &amp;&amp; a.isFile) {
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; return 1;
</div><div>&nbsp; &nbsp; &nbsp; } else {
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (a.name.toLowerCase()&gt;b.name.toLowerCase()) {
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return 1;
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;} else {
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return -1;
</div><div>&nbsp; &nbsp; &nbsp; &nbsp; }
</div><div>&nbsp; &nbsp; }
</div><div>&nbsp;});
</div><div>}</div></td></tr></tbody></table><div><b><br></b><div><div></div><div><br></div><div></div></div></div></div><b style="background-color: rgb(255, 255, 255);">呈现文件列表</b><div><div></div><div><br></div><div>上一节，我们对列表元素是这样定义的</div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto; background-color: rgb(255, 255, 255);"><tbody><tr><td valign="top" style="width: 579px;"><div>&nbsp;&lt;li class="item"&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="check icon-check-empty"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="icon"&gt;&lt;/div&gt;</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="name"&gt;&lt;/div&gt;</div><div>&nbsp; &lt;/li&gt;</div></td></tr></tbody></table><br></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">我们可以将它改写为</span></span></div><div><span style="background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;"><span style="background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;"><div style="background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;"><span style="color: rgb(0, 0, 0);">&nbsp;&lt;li class="</span><font color="#ff0000">template hidden</font>"&gt;</div><div style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="check icon-check-empty"&gt;&lt;/div&gt;</div><div style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="icon"&gt;&lt;/div&gt;</div><div style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;div class="name"&gt;&lt;/div&gt;</div><div style="color: rgb(0, 0, 0); background-color: rgb(255, 255, 255); font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: start;">&nbsp; &lt;/li&gt;</div><br></span></span></div><div>同时， 增加css</div><div>.hidden {</div><div>&nbsp; &nbsp; display:none;</div><div>}</div><div><br></div><div>在代码中，为每个节点，我们克隆这个li，&nbsp;</div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 579px;"><div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">for ( var i = 0; i &lt; entries.length; i++) {</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; var entry = entries[i];</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; var cloned = $(".list .template").clone();
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; cloned.attr("id", "entry-" + entry.name);
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; cloned.removeClass("template").removeClass("hidden").addClass("item");</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;"><br></div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; cloned.data("entry", entry);</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;"><br></div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; $(".list ul").append(cloned);</div></div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">}</div></td></tr></tbody></table></div><div><br></div><div>然后对于文件和文件夹做分别处理</div><div><br></div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 579px;"><div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">cloned.find(".name").html(entry.name);</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">if (entry.isFile) {
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; &nbsp; cloned.find(".icon").addClass("file");
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp;} else {
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; &nbsp; &nbsp;cloned.find(".icon").addClass("folder");
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; &nbsp; &nbsp;cloned.attach(function() {
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; &nbsp; &nbsp;openDir($(this).data("entry"));
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp; &nbsp; });
</div><div style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:left;">&nbsp;}</div></div></td></tr></tbody></table><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><br></span></span></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">最后在整个循环外面，不要忘记加上更新iscroll的控制</span></span></div><div><table border="1" cellpadding="2" cellspacing="0" style="width: auto;"><tbody><tr><td valign="top" style="width: 579px;"><div>myScroll.refresh();</div></td></tr></tbody></table></div><div><br></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><br></span></span></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;">现在我们可以从根开始逐层浏览SD卡上的文件了</span></span></div><div><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><span style="background-color:rgb(255, 255, 255);color:rgb(0, 0, 0);font-family:微软雅黑;font-size:14px;font-style:normal;font-weight:normal;text-align:start;"><br></span></span></div><div><b>小结</b></div><div>本章核心介绍HTML5 File API。 这块可以说是个冷门，但在Cordova里面我觉得还是比较重要的，毕竟很多应用还是需要进行本地SD卡读写的。我们做别的应用可以用来进行sd卡备份、缓存内容、图片等。</div><div><br></div><div><br></div><div><br></div></div></div>


                        
                    </div>
                </section>
            </div>

            <div class="footer">
                <div class="pure-menu pure-menu-horizontal">
                    <ul>
                        <li class="pure-menu-item"><a href="http://purecss.io/" class="pure-menu-link">Copyright © 2014-2015</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
</div>

</body>
</html>